# **Skin Care AI**

A small Streamlit app that detects skin type and common acne issues from a photo (Vision Transformer), queries a Chroma vector DB of skincare products, builds a budget-aware routine, and generates short professional guidance using a local LLM (Ollama).

This repository contains the main application file SkinCareFinalCode.py.

**Features**

Image-based skin detection and multi-label issue prediction using ViT.

Vector search of product descriptions with Chroma (sentence-transformers embeddings).

Routine builder that optimizes for budget and conditions.

Natural-language explanations generated by a local LLM (configured to Ollama).

Simple Streamlit UI for camera capture and result display.

Requirements

Python 3.9+ (test with 3.10 or 3.11)

GPU not required but speeds up inference for some models (the app currently uses CPU by default)

The following Python packages (installable via pip):
streamlit
torch
timm
chromadb
sentence-transformers
pandas
pillow
requests

**Environment variables / configuration**

The app reads these environment variables with sensible defaults:

SKIN_EXCEL — Path to the Excel file with products (default: skincare.db.xlsx)

CHROMA_PATH — Path for Chroma's persistent DB (default: skincare.db)

EMB_MODEL — Sentence Transformer model to use for embeddings (default: sentence-transformers/all-MiniLM-L6-v2)

VIT_MODEL_PATH — Path to the ViT checkpoint used for skin/issue prediction (no default; current script contains an absolute path placeholder you should replace)

IMG_SIZE — Image size expected by the ViT (default 224; can be changed in code)

You can export them before running: export SKIN_EXCEL=/path/to/skincare.xlsx export CHROMA_PATH=/path/to/chromadb export VIT_MODEL_PATH=/path/to/best_vit_multilabel.pt


**Excel format**

The app bootstraps the Chroma collection from an Excel file. The following columns are required in the sheet:

id: 101
brand: Acme
product_name: Gentle Cleanser
price: 9.99
features: "Sulfate-free, fragrance-free"
suitable_for: "oily"
product_type: "cleanser"
If the Excel is missing or columns are missing, the app will show an error.

**How it works**

On first run the app loads the Excel file and upserts products into a Chroma collection using a sentence-transformers embedding function.
The user takes a photo with the camera input component (or you can adapt to upload).
The app uses a bit of Vision Transformer (trained checkpoint) to predict labels for skin type and various acne/skin issues.
It queries Chroma for products that match skin type / issues and filters by user's budget.
A dynamic knapsack-style routine builder chooses one product per slot (cleanser, serum, moisturizer, sunscreen) optimizing a heuristic score.
The chosen products are summed into a prompt that is sent to a local Ollama LLM for a short dermatologist-style explanation.
Local LLM (Ollama) requirements
The app calls a local LLM endpoint at: http://localhost:11434/api/chat or falls back to: http://localhost:11434/api/generate

You must have an Ollama model running locally and exposed on that port (the script uses MODEL_NAME = "gemma3:4b" by default). If Ollama is not running the app will show "LLM unavailable. Check Ollama is running."

Adjust MODEL_NAME in SkinCareFinalCode.py to a model you have available.

**ViT checkpoint**

The file VIT_MODEL_PATH should point to a PyTorch checkpoint with at least the following structure:

checkpoint["model"] — containing model state dict keys
checkpoint["classes"] — list of label strings for multi-label classification
The code expects a deit_tiny_patch16_224 (timm) architecture with sigmoid outputs per class. Adapt the model creation if you use a different architecture.

**Running the app**

Ensure your environment variables are set (or edit the constants at the top of the script).
Ensure the Excel file is available and has the required columns.
Make sure the ViT checkpoint exists and Ollama (if you want LLM explanations) is running.
Run: streamlit run SkinCareFinalCode.py
Open the Streamlit URL printed in the console.


**Notes**

The VIT_MODEL_PATH in the current script points to a Windows-specific path — change it to the correct path for your environment.
You may want to add a requirements.txt (pip freeze or the list above) and a small sample Excel to help onboarding.
Consider adding tests for the routine-building logic and utilities.
The app caches resources with Streamlit decorators — restart Streamlit when you change model files or embeddings.
License & contact
This project is provided as-is. Modify and use as you wish. For questions reach out to the repository owner: Sarahlopez20 (GitHub).
